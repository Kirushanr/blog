[
  
  {
    "title": "Seizing production: a deployment chaos",
    "url": "/posts/seizing-production/",
    "categories": "devsecops",
    "tags": "",
    "date": "2025-07-28 00:00:00 +1000",
    "content": "Synopsis We are going to look at a very simple CI/CD insecurity, that allows anyone who have write privileges  to a deployment pipeline in your organisation, to create chaos in a production environment. We will cover, how this can be accomplished in Azure Devops, GitHub and Bitbucket and how we can mitigate this in simple steps.  CI/CD for layman Most people use the  word  CI/CD as a colloquial term to tell the non-technical folks like me, that they are shipping code using a service, which builds and deploys their software to someone’s computer (aka Cloud/Server running in a basement).    As shown in the diagram above,    A developer writes the code, pushes it to a remote repository   Based on the pipeline definition (we are assuming that the repository has one) it will build the code and a build artifact gets generated (e.g. Docker image)   The build artifact then gets deployed to an intended destination (e.g. a server)   Looks so simple isn’t it !,  wait until your customers hears about this !. Kenevil enters the pipeline   There is no CI/CD security writeups without branch protection. It is the fundamental defence in protecting your source code from unintended modification.  Branch protection is a simple set of rules that enforces who can do what to the source code in a branch.  I am not going to deep dive into the branching strategies, let’s keep it simple and say we use main as our production branch. A branch that contains production code should have at least the following rules:    No one should be able to edit/modify/write anything to the main branch directly (e.g. Force push)   Any PRs to the production branch should at least be reviewed by two people  (four-eyes principle) excluding the person who is making the change. Everything else can be tweaked and modified according to your specific situation   All major source code providers have great literature on how this can be accomplished :    GitHub   Azure Repos    BitBucket   Now we pat ourselves in the back for the job well done … , but I want to disappoint you and say that someone with the right intentions can still ship code to production bypassing the branch protection.    As I highlight in the above diagram, most pipelines let this wide open, anyone can create a branch and trigger the pipeline to build and deploy a build artifact to a production environment. For example, a malicious actor can create an evil branch and sneakily deploy a malicious version of an artifact to end users.  In the next sections, we will look at how this insecurity exists  on all major services we mentioned eariler. Github action Now in GitHub actions, the environment does not set restrictions on which branch can deploy, see the the example image shown below.    Since, we have branch protection, we should set this setting to selected branches and tags and restrict it to that branch. Ensure that you are using environments feature with this setting enabled.  You can read GitHub’s official documentation.  Azure DevOps In Azure DevOps similar insecurity exists, this can occur in an Azure DevOps environment or Agent Pool . This totally depends on how someone is deploying and where they are deploying. Creating an environment provisions the Agent pool with the restrictions, but if you are creating an Agent pool directly, then it has to be enforced there.  In an Azure DevOps environment, this setting is hiding under Approval and checks tab and called Branch control.   In an agent pool, these settings are hiding under the same spot. Now we need to ensure this branch is set to our protected branch, e.g. main.    You can read Azure DevOps official documentation  Bitbucket On Atlassian Bitbucket, you must pay the Security Tax to unlock this feature, It can only be enabled in Premium plan of Bitbucket and you must use deployments.    You can read the Atlassian release documentation here   Epilogue     Attack him where he is unprepared, appear where you are not expected - Sun Tzu     (Art of War : Chapter 1  - Laying plans)   Most CI/CD pipelines are insecure by default, I suggest that you take a look at OWASP CI/CD Security Cheat sheet  to  harden your environment based on your workflows and business requirements.  Thank you for reading this post, hopefully you learnt something today :). I will see you in another 4 years, in my next post …."
  },
  
  {
    "title": "Knowing the unknown:  discovering devices connected to the internet",
    "url": "/posts/knowing-the-unknown-discovering-devices-connected-to-the-internet/",
    "categories": "network",
    "tags": "",
    "date": "2021-09-25 00:00:00 +1000",
    "content": "Introduction  The present-day internet sees everything from smart toothbrushes, unsecured databases, CCTVs  and dirty dishes soaking in a smart kitchen  right now .  By 2023 the number of devices connected to the internet will be approximately 29.3 billion. More devices joining the internet with little or no security  have become a lucrative target for threat actors.  This article describes a few tools we can use to identify and monitor our devices connected to the internet on a budget.     If you know the enemy and know yourself, you need not fear the result of a hundred battles. If you know yourself but not the enemy, for every victory gained, you will also suffer a defeat. If you know neither the enemy nor yourself, you will succumb in every battle. - Sun Tzu   Passive reconnaissance  The first phase of hacking is reconnaissance (recon), where the attacker research and gathers information about a target.  Passive reconnaissance collects information about a target without raising alarms; this phase does not directly interact with a target or its network assets.  There are SaaS (Software As A Service Platforms), which provide information gathered from actively scanning the internet (Active Reconnaissance). They are passive recon tools.  Shodan  Shodan is the world’s first search engine for Internet-connected devices and my favourite tool.    Shodan allows you to search devices based on various metadata, including but not limited to IP address, CVE (Common Vulnerability Exposure), HTTP banners, and the list go on.  In addition, they do provide network monitoring features where if something pops up in your given IP address space, the service will send you an alert. According to Shodan’s documentation, it scans the entire internet at least once a week. However, their API does provide on-demand scanning if you want to build continuous scanning and alerting.  Quickly check if your IP is exposing any ports to the Internet by visiting https://t.co/suJA6fndpXIf you see a 404 page then you don&#39;t have anything exposed!&mdash; Shodan (@shodanhq) September 21, 2020   Shodan pro subscriptions cost 49 $ a month, but they offer 5$/per month pro shodan accounts during the Black Friday sale.  If you have a .edu email, they offer the pro account features for free.  Greynoise  Greynoise comes in handy if we want to identify any compromised devices within a specified IP address range.    Greynoise does provide a free community subscription, allowing users to search IP addresses to identify whether they have been compromised and scanning the internet for other machines to infect.    Active Recon  Nmap  Nmap is the go-to opensource tool for network discovery and if you want to host your network scanning service. Nmap  comes in many flavours.     Zenmap GUI version   Dockerized Version   CLI   Nmap can be used to find open-ports,  OS fingerprinting and vulnerabilities too.  If you need an excellent place to start on continous network scanning Jeremy Gamblin has written a simple guide on that with alerting.  Conclusion  Attackers put in the time to know the network and the devices better than the defenders. That’s how they win.&mdash; Rob Joyce (@NSA_CSDirector) September 13, 2021   As defenders, we need to monitor the devices connected to the internet to prevent/identify a breach. We can only defend what we can see !.  Misconfigured and vulnerable devices are the root cause of some of the notable hacks in the past :     Printers Were Exploited for PewDiePie Propaganda   An unsecured database exposed thousands of British passports   Hackers Enlisted Tesla’s Public Cloud to Mine Cryptocurrency   How a Dorm Room Minecraft Scam Brought Down the Internet"
  },
  
  {
    "title": "Taking down phishing scams : a DIY approach",
    "url": "/posts/taking-down-phishing-scams-a-diy-approach/",
    "categories": "phishing",
    "tags": "",
    "date": "2021-08-25 00:00:00 +1000",
    "content": "Synopsis  In this article, I revisit a DIY approach I took to take down a scammer’s infrastructure during the last holiday season.   Stop and Think If you have lost money or data to a phishing scam, please stop reading this article and contact law enforcement or get help.    Australia:  https://www.scamwatch.gov.au/get-help/where-to-get-help   USA: https://www.usa.gov/stop-scams-frauds   The Link  You may have received one or more links from scammers with the description of “You have won an iPhone” or “A parcel is waiting for clearance” click here to claim it. Once you click the link, the link may direct you to a website, which could deceive you into entering PII (Personally Identifiable Information).  This attack is identified as phishing but based on the threat vector; it can be classified differently.  For example, Smishing  uses SMS as a medium to target users.    Analysis  The first step of the analysis begins with the link I received from the scammer. The link is the most important clue, as it may reveal the phishing infrastructures behind the scam.  I primarily used URLSCAN.io for my investigation . It is a web-based sandbox environment that scans and analyzes a given link. It provides detailed information about the link you were about to click.    An initial scan of that particular URL rendered an empty page.  As web users, we know that websites may behave differently based on the device/browser. One of the techniques servers use to identify the browser is through the User-Agent, sent with the request to the server.  The above theory prompted me to try something with URLSCAN.io. I switched and tried multiple User-Agents with different Operating systems.  But I finally got lucky with the mobile user agent iOS Safari,  a nicely designed web app was prompting me to enter my email to claim an iPhone.    The scammers have hosted the primary user interface, the data collection user interface, on two separate hosting infrastructures. The reason could be that if someone takes down the primary domain and its infrastructure, the data is stored securely in the secondary hosting infrastructure.     Reporting  The key to taking down phishing infrastructure is to reporting it to hosting providers. In addition, reporting it to browser makers and antivirus companies could mark the domain as malicious/suspicious.  The below image shows an example of URLSCAN.io results.    SwiftOnSecurity has written a comprehensive How-To at Decent Security on how to do this. Let me you take through the list of steps I used.          Reporting it to Google Safe Browsing team was the initial step . Google shares this data with third parties, including browsers makers who use Google’s Safe Browsing API to block phishing and malware.           Using the hosting information I gathered in the analysis phase, I reported it to Amazon Web Services  and Digital Ocean  through their abuse forms.  The key is to provide as much information as possible, including a screenshot and links where appropriate.           Since this scam targeted users primarily based in Australia, I  also sent the report to ScamWatch Australia.         The waiting game  Hosting providers get tons of abuse reports a day. The average turnaround time could be days, weeks,  or may be months.     AWS got back to me after three days, and they took down the primary domain I reported.        DigitalOcean did get back to me after two days. However, the site was still active during their investigation even after that.        As of this writing none of the reported domains are active.    Conclusion  Taking down phishing scams are similar to the whack a mole game; there will be another  when you take down one. However, reporting them is the key to prevent others from falling into the scam.  If you need to read the more comprehensive guide, please bookmark  Decent Security and revisit it when you get another Smishing/Phishing scam.  Happy Hunting !!!."
  }
  
]

